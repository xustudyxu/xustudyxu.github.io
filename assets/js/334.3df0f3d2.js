(window.webpackJsonp=window.webpackJsonp||[]).push([[334],{682:function(s,e,a){"use strict";a.r(e);var t=a(10),n=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"docker-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装"}},[s._v("#")]),s._v(" Docker 安装")]),s._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#centos-docker安装"}},[s._v("CentOS Docker安装")])]),e("li",[e("a",{attrs:{href:"#docker的基本组成"}},[s._v("Docker的基本组成")])]),e("li",[e("a",{attrs:{href:"#docker平台架构图解-入门版"}},[s._v("Docker平台架构图解(入门版)")])]),e("li",[e("a",{attrs:{href:"#docker平台架构图解-架构版"}},[s._v("Docker平台架构图解(架构版)")])]),e("li",[e("a",{attrs:{href:"#操作系统要求"}},[s._v("操作系统要求")])]),e("li",[e("a",{attrs:{href:"#卸载旧版本"}},[s._v("卸载旧版本")])]),e("li",[e("a",{attrs:{href:"#安装方法"}},[s._v("安装方法")]),e("ul",[e("li",[e("a",{attrs:{href:"#使用存储库安装"}},[s._v("使用存储库安装")])]),e("li",[e("a",{attrs:{href:"#从包安装"}},[s._v("从包安装")])]),e("li",[e("a",{attrs:{href:"#便利脚本安装"}},[s._v("便利脚本安装")])])])]),e("li",[e("a",{attrs:{href:"#安装进阶"}},[s._v("安装进阶")]),e("ul",[e("li",[e("a",{attrs:{href:"#以非root用户管理docker"}},[s._v("以非root用户管理Docker")])]),e("li",[e("a",{attrs:{href:"#配置docker开机启动"}},[s._v("配置Docker开机启动")])])])]),e("li",[e("a",{attrs:{href:"#仓库配置"}},[s._v("仓库配置")]),e("ul",[e("li",[e("a",{attrs:{href:"#docker-官方中国的镜像加速器"}},[s._v("Docker 官方中国的镜像加速器")])]),e("li",[e("a",{attrs:{href:"#配置阿里云镜像加速器"}},[s._v("配置阿里云镜像加速器")])])])]),e("li",[e("a",{attrs:{href:"#镜像查看和拉取"}},[s._v("镜像查看和拉取")])]),e("li",[e("a",{attrs:{href:"#为什么docker会比vm虚拟机快"}},[s._v("为什么Docker会比VM虚拟机快")])]),e("li",[e("a",{attrs:{href:"#卸载docker引擎"}},[s._v("卸载Docker引擎")])])])]),e("p"),s._v(" "),e("h2",{attrs:{id:"centos-docker安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#centos-docker安装"}},[s._v("#")]),s._v(" CentOS Docker安装")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting1@master/20220904/image.3b1ygz3skt80.webp",alt:"image"}})]),s._v(" "),e("p",[e("strong",[s._v("前提条件")])]),s._v(" "),e("p",[s._v("目前，CentOS 仅发行版本中的内核支持 Docker。"),e("strong",[s._v("Docker 运行在CentOS 7 (64-bit)上，")])]),s._v(" "),e("p",[e("strong",[s._v("要求系统为64位、Linux系统内核版本为 3.8以上，这里选用Centos7.x")])]),s._v(" "),e("p",[e("strong",[s._v("查看自己的内核")])]),s._v(" "),e("p",[s._v("uname命令用于打印当前系统相关信息（内核版本号、硬件架构、主机名称和操作系统类型等）。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uname -a")]),s._v("\nLinux master "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),s._v(".0-1160.el7.x86_64 "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1 SMP Mon Oct 19 16:18:59 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"docker的基本组成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker的基本组成"}},[s._v("#")]),s._v(" Docker的基本组成")]),s._v(" "),e("ul",[e("li",[s._v("镜像(image)")])]),s._v(" "),e("p",[s._v("Docker 镜像（Image）就是一个"),e("mark",[s._v("只读")]),s._v("的模板。镜像可以用来创建 Docker 容器，"),e("strong",[s._v("一个镜像可以创建很多容器")]),s._v("。")]),s._v(" "),e("p",[s._v("它也相当于是一个root文件系统。比如官方镜像 centos:7 就包含了完整的一套 centos:7 最小系统的 root 文件系统。")]),s._v(" "),e("p",[s._v("相当于容器的“源代码”，"),e("strong",[s._v("docker镜像文件类似于Java的类模板，而docker容器实例类似于java中new出来的实例对象")]),s._v("。")]),s._v(" "),e("p",[s._v("容器与镜像的关系类似于面向对象编程中的对象与类：")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("Docker")]),s._v(" "),e("th",[s._v("面向对象")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("容器")]),s._v(" "),e("td",[s._v("对象")])]),s._v(" "),e("tr",[e("td",[s._v("镜像")]),s._v(" "),e("td",[s._v("类")])])])]),s._v(" "),e("ul",[e("li",[s._v("容器(container)")])]),s._v(" "),e("ol",[e("li",[e("strong",[s._v("从面向对象角度")])])]),s._v(" "),e("p",[s._v("Docker 利用容器（Container）独立运行的一个或一组应用，应用程序或服务运行在容器里面，容器就类似于一个虚拟化的运行环境，"),e("strong",[s._v("容器是用镜像创建的运行实例")]),s._v("。就像是Java中的类和实例对象一样，镜像是静态的定义，容器是镜像运行时的实体。容器为镜像提供了一个标准的和隔离的运行环境，它可以被启动、开始、停止、删除。每个容器都是相互隔离的、保证安全的平台。")]),s._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[e("strong",[s._v("从镜像容器角度")])])]),s._v(" "),e("p",[e("strong",[s._v("可以把容器看做是一个简易版的")]),s._v(" "),e("strong",[s._v("Linux")]),s._v(" "),e("strong",[s._v("环境")]),s._v("（包括root用户权限、进程空间、用户空间和网络空间等）和运行在其中的应用程序。")]),s._v(" "),e("ul",[e("li",[s._v("仓库(repository)")])]),s._v(" "),e("p",[s._v("仓库（Repository）是"),e("mark",[s._v("集中存放镜像")]),s._v("文件的场所。")]),s._v(" "),e("p",[s._v("类似于Maven仓库，存放各种jar包的地方；github仓库，存放各种git项目的地方；Docker公司提供的官方registry被称为Docker Hub，存放各种镜像模板的地方。")]),s._v(" "),e("p",[s._v("仓库分为公开仓库（Public）和私有仓库（Private）两种形式。")]),s._v(" "),e("p",[e("strong",[s._v("最大的公开仓库是 DockerHub")]),s._v("("),e("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://hub.docker.com/"),e("OutboundLink")],1),s._v(")，存放了数量庞大的镜像供用户下载。国内的公开仓库包括阿里云 、网易云等")]),s._v(" "),e("ul",[e("li",[s._v("小总结")])]),s._v(" "),e("p",[s._v("需要正确的理解仓库/镜像/容器这几个概念:")]),s._v(" "),e("p",[s._v("Docker 本身是一个容器运行载体或称之为管理引擎。我们把应用程序和配置依赖打包好形成一个可交付的运行环境，这个打包好的运行环境就是image镜像文件。只有通过这个镜像文件才能生成Docker容器实例(类似Java中new出来一个对象)。")]),s._v(" "),e("p",[s._v("image文件可以看作是容器的模板。Docker 根据image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。")]),s._v(" "),e("p",[e("strong",[s._v("镜像文件")])]),s._v(" "),e("p",[s._v("image 文件生成的容器实例，本身也是一个文件，称为镜像文件。")]),s._v(" "),e("p",[e("strong",[s._v("容器实例")])]),s._v(" "),e("p",[s._v("一个容器运行一种服务，当我们需要的时候，就可以通过docker客户端创建一个对应的运行实例，也就是我们的容器。")]),s._v(" "),e("p",[e("strong",[s._v("仓库")])]),s._v(" "),e("p",[s._v("就是放一堆镜像的地方，我们可以把镜像发布到仓库中，需要的时候再从仓库中拉下来就可以了。")]),s._v(" "),e("h2",{attrs:{id:"docker平台架构图解-入门版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker平台架构图解-入门版"}},[s._v("#")]),s._v(" Docker平台架构图解(入门版)")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting1@master/20220904/image.1dhfdk9cfh1c.webp",alt:"image"}})]),s._v(" "),e("h2",{attrs:{id:"docker平台架构图解-架构版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker平台架构图解-架构版"}},[s._v("#")]),s._v(" Docker平台架构图解(架构版)")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("首次懵逼正常，后续深入，先有大概轮廓，混个眼熟")])]),s._v(" "),e("li",[e("p",[s._v("整体架构及底层通信原理简述")])])]),s._v(" "),e("p",[s._v("Docker 是一个 C/S 模式的架构，后端是一个松耦合架构，众多模块各司其职。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting1@master/20220904/image.6zaea6xum9k0.webp",alt:"image"}})]),s._v(" "),e("p",[s._v("Docker运行的基本流程：")]),s._v(" "),e("ol",[e("li",[s._v("用户是使用Docker Client与 Docker Daemon建立通信，并发送请求给后者。")]),s._v(" "),e("li",[s._v("Docker Daemon作为Docker架构中的主体部分，首先提供Docker Server的功能使其可以接受Docker Client 的请求。")]),s._v(" "),e("li",[s._v("Docker Engine执行Docker 内部的一系列工作，每一项工作都是以一个Job的形式的存在。")]),s._v(" "),e("li",[s._v("Job的运行过程中，当需要容器镜像时，则从Docker Registry 中下载镜像，并通过镜像管理驱动Graph driver将下载镜像以Graph的形式存储。")]),s._v(" "),e("li",[s._v("当需要为Docker创建网络环境时，通过网络管理驱动Network driver创建并配置Docker容器网络环境。")]),s._v(" "),e("li",[s._v("当需要限制Docker容器运行资源或执行用户指令等操作时，则通过Exec driver来完成。")]),s._v(" "),e("li",[s._v("Libcontainer是一项独立的容器管理包，Network driver以及Exec driver都是通过Libcontainer来实现具体对容器进行的操作。")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting1@master/20220904/image.7hh30r9dad40.webp",alt:"image"}})]),s._v(" "),e("h2",{attrs:{id:"操作系统要求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#操作系统要求"}},[s._v("#")]),s._v(" 操作系统要求")]),s._v(" "),e("p",[s._v("要安装 Docker 引擎，您需要 CentOS 7 或 8 的维护版本。不支持或测试存档版本，并且 Linux 版本 3.10.0+，包括 3.10.0。")]),s._v(" "),e("p",[s._v("该 "),e("code",[s._v("centos-extras")]),s._v(" 库必须启用。默认情况下启用此存储库，但如果您已禁用它，则需要 "),e("a",{attrs:{href:"https://wiki.centos.org/AdditionalResources/Repositories",target:"_blank",rel:"noopener noreferrer"}},[s._v("重新启用它"),e("OutboundLink")],1),s._v("。")]),s._v(" "),e("p",[e("code",[s._v("overlay2")]),s._v(" 推荐使用存储驱动。")]),s._v(" "),e("h2",{attrs:{id:"卸载旧版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#卸载旧版本"}},[s._v("#")]),s._v(" 卸载旧版本")]),s._v(" "),e("p",[s._v("旧版本的 Docker 被称为 "),e("code",[s._v("docker")]),s._v(" 或 "),e("code",[s._v("docker-engine")]),s._v("。如果安装了这些，请卸载它们以及相关的依赖项：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-client "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-client-latest "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-common "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-latest "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-latest-logrotate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-logrotate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-engine\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("如果 "),e("code",[s._v("yum")]),s._v(" 报告没有安装这些软件包，那也没关系，只是说明曾经没安装过，不影响任何东西。")]),s._v(" "),e("p",[s._v("卸载并不会全部卸载，如图像、容器、卷和网络，将被保留，以及 "),e("code",[s._v("/var/lib/docker/")]),s._v(" 的内容")]),s._v(" "),e("p",[s._v("Docker 引擎包现在被称为 "),e("code",[s._v("docker-ce")]),s._v(".")]),s._v(" "),e("h2",{attrs:{id:"安装方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装方法"}},[s._v("#")]),s._v(" 安装方法")]),s._v(" "),e("p",[s._v("保证CentOS能够正常上网。")]),s._v(" "),e("ol",[e("li",[s._v("yum安装gcc相关")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("yum "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gcc\nyum "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gcc-c++\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("首先说明下：Docker 安装路径是 "),e("code",[s._v("/var/lib/docker")]),s._v("，安装 Docker 成功后，在该路径中有一个 image 和 containers 文件夹，分别存放镜像和实例。")]),s._v(" "),e("p",[s._v("您可以根据需要以不同方式安装 Docker Engine：")]),s._v(" "),e("ul",[e("li",[s._v("从 Docker 的存储库或者其他镜像库里下载，这是最推荐的方法")]),s._v(" "),e("li",[s._v("下载 RPM 包并手动安装并完全手动管理升级。这在某些情况下非常有用，例如在无法访问互联网的气隙系统上安装 Docker")]),s._v(" "),e("li",[s._v("便捷脚本安装 Docker，可以在测试和开发环境中安装")])]),s._v(" "),e("h3",{attrs:{id:"使用存储库安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用存储库安装"}},[s._v("#")]),s._v(" 使用存储库安装")]),s._v(" "),e("p",[s._v("在新主机上首次安装 Docker Engine 之前，您需要设置 Docker 存储库。之后，您可以从存储库安装和更新 Docker。")]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("安装软件包")])])]),s._v(" "),e("p",[s._v("安装 "),e("code",[s._v("yum-utils")]),s._v(" 包，它提供 "),e("code",[s._v("yum-config-manager")]),s._v(" 实用程序")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" yum-utils\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("设置存储库")])])]),s._v(" "),e("p",[s._v("设置稳定版本的仓库")]),s._v(" "),e("p",[s._v("官网（国外）")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t\t--add-repo "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t\thttps://download.docker.com/linux/centos/docker-ce.repo\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("阿里云（国内）")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    \t--add-repo "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t\thttp://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("阿里云仓库也是定期从官网仓库进行更新引用，两者仓库量无太大区别，如果配置了阿里云仓库，也要配置阿里云镜像加速，即下载速度源由官网改为阿里云。")]),s._v(" "),e("ul",[e("li",[s._v("最新版本安装")]),s._v(" "),e("li",[s._v("特定版本安装")])]),s._v(" "),e("p",[s._v("安装 "),e("strong",[s._v("最新版本")]),s._v(" 的 Docker Engine 和 containerd：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果希望自己手动确认一些安装条件，则把 "),e("code",[s._v("-y")]),s._v(" 去掉。")]),s._v(" "),e("p",[s._v("如果报如下错误：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("Loaded plugins: fastestmirror\nLoading mirror speeds from cached hostfile\nNo package docker-ce available.\nNo package docker-ce-cli available.\nNo package containerd.io available.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("要么你的 Linux 版本没到达 3.10.+，要么你忽略了上方的设置存储库，请设置官方或者阿里云的存储库，否则无法找到 Docker。")]),s._v(" "),e("p",[s._v("还有一种可能就是你的 yum 版本太低，请更新它。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新 yum")]),s._v("\nyum update\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CentOS 7 更新索引")]),s._v("\nyum makecache fast\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CentOS 8 更新索引")]),s._v("\nyum makecache\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("安装 "),e("strong",[s._v("特定版本")]),s._v(" 的 Docker Engine，请在 repo 中列出可用版本，然后选择并安装")]),s._v(" "),e("p",[s._v("首先列出可以安装的版本：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("yum list docker-ce "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--showduplicates")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例子：")]),s._v("\ndocker-ce.x86_643:18.09.1-3.el7\t\t\tdocker-ce-stable\ndocker-ce.x86_643:18.09.0-3.el7\t\t\tdocker-ce-stable\ndocker-ce.x86_6418.06.1.ce-3.el7\t\tdocker-ce-stable\ndocker-ce.x86_6418.06.e.ce-3.el7\t\tdocker-ce-stable\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("返回的列表取决于启用的存储库，并且特定于您的 CentOS 版本（e17 就是 CentOS 7.x 版本，如果是 CentOS 8.2，则是 e18）")]),s._v(" "),e("p",[s._v("通过完全限定的包名称安装特定版本，即包名称 ("),e("code",[s._v("docker-ce")]),s._v(") 加上从第一个冒号 ("),e("code",[s._v(":")]),s._v(")开始的版本字符串（第 2 列），直到第一个连字符，由连字符 ("),e("code",[s._v("-")]),s._v(")分隔。例如："),e("code",[s._v("docker-ce-18.09.1")]),s._v("。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" docker-ce-cli-"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" containerd.io\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例子")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-18.09.1 docker-ce-cli-18.09.1 containerd.io\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("此命令会安装 Docker，但不会启动 Docker。它还会创建一个 "),e("code",[s._v("docker")]),s._v(" 组，但是，默认情况下它不会向该组添加任何用户。")]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("启动 Docker")])])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("测试是否启动成功")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行该命令")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl status "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行结果，出现 active (running) 代表启动成功")]),s._v("\n● docker.service - Docker Application Container Engine\n   Loaded: loaded "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/docker.service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" disabled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: disabled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since 五 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-11-19 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":40:03 CST"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 1s ago\n     Docs: https://docs.docker.com\n Main PID: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("29970")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dockerd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    Tasks: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("\n   Memory: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("114")]),s._v(".0M\n   CGroup: /system.slice/docker.service\n           └─29970 /usr/bin/dockerd "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" fd:// "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--containerd")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run/containerd/containerd.sock\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("p",[s._v("其他命令：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 docker 的状态")]),s._v("\nsystemctl status "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启 docker")]),s._v("\nsystemctl restart "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 docker 服务开启自启动")]),s._v("\nsystemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("验证安装")])])]),s._v(" "),e("p",[s._v("查看 Docker 版本")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("查看 Docker 信息")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("测试运行")])])]),s._v(" "),e("p",[s._v("通过运行 "),e("code",[s._v("hello-world")]),s._v(" 映像验证 Docker Engine 是否已正确安装")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行该命令")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行结果")]),s._v("\nHello from Docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nThis message shows that your installation appears to be working correctly.\n\nTo generate this message, Docker took the following steps:\n "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". The Docker client contacted the Docker daemon.\n "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". The Docker daemon pulled the "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello-world"')]),s._v(" image from the Docker Hub.\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amd64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". The Docker daemon created a new container from that image "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" runs the\n    executable that produces the output you are currently reading.\n "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". The Docker daemon streamed that output to the Docker client, "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" sent it\n    to your terminal.\n\nTo try something "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" ambitious, you can run an Ubuntu container with:\n $ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" ubuntu "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n\nShare images, automate workflows, and "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" with a "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" Docker ID:\n https://hub.docker.com/\n\nFor "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" examples and ideas, visit:\n https://docs.docker.com/get-started/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("p",[s._v("此命令下载测试映像并在容器中运行它。当容器运行时，它会打印一条消息并退出。")]),s._v(" "),e("h3",{attrs:{id:"从包安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#从包安装"}},[s._v("#")]),s._v(" 从包安装")]),s._v(" "),e("p",[s._v("如果您无法使用 Docker 的存储库来安装 Docker，您可以下载该"),e("code",[s._v(".rpm")]),s._v("版本的 文件并手动安装。每次要升级 Docker Engine 时都需要下载一个新文件。")]),s._v(" "),e("p",[s._v("前往 "),e("a",{attrs:{href:"https://download.docker.com/linux/centos/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://download.docker.com/linux/centos/ (opens new window)"),e("OutboundLink")],1),s._v("并选择您的 CentOS 版本。然后浏览 "),e("code",[s._v("x86_64/stable/Packages/")]),s._v(" 并下载 "),e("code",[s._v(".rpm")]),s._v(" 要安装的 Docker 版本的文件。")]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("安装")])])]),s._v(" "),e("p",[s._v("安装 Docker Engine，将下面的路径更改为您下载 Docker 包的路径。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" /path/to/package.rpm\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Docker 已安装但未启动。该 "),e("code",[s._v("docker")]),s._v(" 组被创建，但没有用户添加到组。")]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("启动 Docker")])])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("其他命令：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 docker 的状态")]),s._v("\nsystemctl status "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启 docker")]),s._v("\nsystemctl restart "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 docker 服务开启自启动")]),s._v("\nsystemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("验证安装")])])]),s._v(" "),e("p",[s._v("查看 Docker 版本")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("查看 Docker 信息")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("测试运行")])])]),s._v(" "),e("p",[s._v("通过运行 "),e("code",[s._v("hello-world")]),s._v(" 映像验证 Docker Engine 是否已正确安装")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("此命令下载测试映像并在容器中运行它。当容器运行时，它会打印一条消息并退出。")]),s._v(" "),e("h3",{attrs:{id:"便利脚本安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#便利脚本安装"}},[s._v("#")]),s._v(" 便利脚本安装")]),s._v(" "),e("p",[s._v("Docker 在 "),e("a",{attrs:{href:"https://get.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("get.docker.com (opens new window)"),e("OutboundLink")],1),s._v("上提供了一个方便的脚本，可以快速且非交互式地将 Docker 安装到开发环境中。不建议将便捷脚本用于生产环境，但可以用作示例来创建适合您需求的配置脚本。")]),s._v(" "),e("p",[s._v("在本地运行之前，请务必检查从 Internet 下载的脚本。在安装之前，让自己熟悉便利脚本的潜在风险和限制：")]),s._v(" "),e("ul",[e("li",[s._v("脚本需要 "),e("code",[s._v("root")]),s._v(" 或 "),e("code",[s._v("sudo")]),s._v(" 特权才能运行。")]),s._v(" "),e("li",[s._v("该脚本会尝试检测您的 Linux 发行版和版本并为您配置包管理系统，并且不允许您自定义大多数安装参数。")]),s._v(" "),e("li",[s._v("该脚本无需确认即可安装依赖项和建议。这可能会安装大量软件包，具体取决于主机的当前配置。")]),s._v(" "),e("li",[s._v("默认情况下，该脚本会安装 Docker、containerd 和 runc 的最新稳定版本。使用此脚本配置机器时，可能会导致 Docker 的主要版本意外升级。在部署到生产系统之前，始终在测试环境中测试（主要）升级。")]),s._v(" "),e("li",[s._v("该脚本并非旨在升级现有的 Docker 安装。使用脚本更新现有安装时，依赖项可能不会更新到预期版本，从而导致使用过时的版本。")])]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("安装")])])]),s._v(" "),e("p",[s._v("此示例从 "),e("a",{attrs:{href:"https://get.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("get.docker.com (opens new window)"),e("OutboundLink")],1),s._v("下载脚本并运行它以在 Linux 上安装 Docker 的最新稳定版本，另外可以通过 "),e("code",[s._v("--mirror")]),s._v(" 选项使用国内下载源进行安装：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fsSL")]),s._v(" https://get.docker.com "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" get-docker.sh\n "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" get-docker.sh "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--mirror")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("启动 Docker")])])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("其他命令：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 docker 的状态")]),s._v("\nsystemctl status "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启 docker")]),s._v("\nsystemctl restart "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 docker 服务开启自启动")]),s._v("\nsystemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("创建 docker 用户组")])])]),s._v(" "),e("p",[s._v("便利脚本安装不会自动创建 docker 用户组，请手动安装")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("验证测试")])])]),s._v(" "),e("p",[s._v("查看 Docker 版本")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("查看 Docker 信息")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("测试运行")])])]),s._v(" "),e("p",[s._v("通过运行 "),e("code",[s._v("hello-world")]),s._v(" 映像验证 Docker Engine 是否已正确安装")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("此命令下载测试映像并在容器中运行它。当容器运行时，它会打印一条消息并退出。")]),s._v(" "),e("h2",{attrs:{id:"安装进阶"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装进阶"}},[s._v("#")]),s._v(" 安装进阶")]),s._v(" "),e("h3",{attrs:{id:"以非root用户管理docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#以非root用户管理docker"}},[s._v("#")]),s._v(" 以非root用户管理Docker")]),s._v(" "),e("p",[s._v("Docker 守护进程绑定到 Unix 套接字而不是 TCP 端口。默认情况下，Unix 套接字归用户所有 "),e("code",[s._v("root")]),s._v("，其他用户只能使用 "),e("code",[s._v("sudo")]),s._v(". Docker 守护进程始终以"),e("code",[s._v("root")]),s._v(" 用户身份运行。")]),s._v(" "),e("p",[s._v("如果您不想在 "),e("code",[s._v("docker")]),s._v(" 命令前加上 "),e("code",[s._v("sudo")]),s._v("，请创建一个 "),e("code",[s._v("docker")]),s._v(" 用户组并向其中添加用户。当 Docker 守护进程启动时，它会创建一个可由 "),e("code",[s._v("docker")]),s._v(" 组成员访问的 Unix 套接字。")]),s._v(" "),e("ol",[e("li",[s._v("创建 "),e("code",[s._v("docker")]),s._v(" 组")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("将您的用户添加到 "),e("code",[s._v("docker")]),s._v(" 组中")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aG")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("注销并重新登录，以便重新评估您的组成员身份。")])]),s._v(" "),e("p",[s._v("如果在虚拟机上进行测试，可能需要重新启动虚拟机以使更改生效。")]),s._v(" "),e("p",[s._v("在桌面 Linux 环境（例如 X Windows）上，完全注销会话，然后重新登录。")]),s._v(" "),e("p",[s._v("在 Linux 上，您还可以运行以下命令来激活对组的更改：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("newgrp "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"4"}},[e("li",[s._v("验证您可以在"),e("code",[s._v("docker")]),s._v("没有"),e("code",[s._v("sudo")]),s._v(".")])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("此命令下载测试映像并在容器中运行它。当容器运行时，它会打印一条消息并退出。")]),s._v(" "),e("p",[s._v("如果您 "),e("code",[s._v("sudo")]),s._v(" 在将用户添加到 "),e("code",[s._v("docker")]),s._v(" 组之前最初使用 Docker CLI 命令运行，您可能会看到以下错误，这表明您的 "),e("code",[s._v("~/.docker/")]),s._v(" 目录由于 "),e("code",[s._v("sudo")]),s._v(" 命令而使用不正确的权限创建。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("WARNING: Error loading config file: /home/user/.docker/config.json -\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" /home/user/.docker/config.json: permission denied\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("要解决此问题，请删除 "),e("code",[s._v("~/.docker/")]),s._v(" 目录（它会自动重新创建，但所有自定义设置都将丢失），或使用以下命令更改其所有权和权限：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v('"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v('"')]),s._v(" /home/"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v('"')]),s._v("/.docker "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" g+rwx "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v('/.docker"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"配置docker开机启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置docker开机启动"}},[s._v("#")]),s._v(" 配置Docker开机启动")]),s._v(" "),e("p",[s._v("多数当前的 Linux 发行版（RHEL、CentOS、Fedora、Debian、Ubuntu 16.04 及更高版本）用于 systemd 管理系统启动时启动的服务（就是 "),e("code",[s._v("systemctl")]),s._v(" 命令）。在 Debian 和 Ubuntu 上，Docker 服务默认配置为在启动时启动。要在引导时为其他发行版自动启动 Docker 和 Containerd，请使用以下命令：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可省略 .service")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker.service\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" containerd.servic\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("要禁用此开机启动，请改用为 "),e("code",[s._v("disable")]),s._v("。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可省略 .service")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl disable docker.service\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl disable containerd.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"仓库配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#仓库配置"}},[s._v("#")]),s._v(" 仓库配置")]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("Docker 安装好以后，我们就要开始为拉取镜像准备了；国内从 DockerHub 拉取镜像有时会特别慢，此时可以配置镜像加速器。")])])]),s._v(" "),e("p",[s._v("Docker 官方和国内很多云服务商都提供了国内加速器服务，比如：")]),s._v(" "),e("ul",[e("li",[s._v("阿里云的加速器：https://help.aliyun.com/document_detail/60750.html")]),s._v(" "),e("li",[s._v("网易加速器：http://hub-mirror.c.163.com")]),s._v(" "),e("li",[s._v("Docker 官方中国加速器：https://registry.docker-cn.com")]),s._v(" "),e("li",[s._v("ustc 的镜像：https://docker.mirrors.ustc.edu.cn")]),s._v(" "),e("li",[s._v("daocloud：https://www.daocloud.io/mirror#accelerator-doc（注册后使用）")])]),s._v(" "),e("h3",{attrs:{id:"docker-官方中国的镜像加速器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-官方中国的镜像加速器"}},[s._v("#")]),s._v(" Docker 官方中国的镜像加速器")]),s._v(" "),e("p",[s._v("对于使用 systemd 的系统（CentOS 7.x 以上），请在 /etc/docker/daemon.json 中写入如下内容（如果文件不存在请新建该文件）")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://registry.docker-cn.com"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("另一种方式")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建文件夹")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /etc/docker\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面是一个步骤，全部复制")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n\t{\n\t\t"registry-mirrors": ["https://registry.docker-cn.com"]\n\t}\nEOF')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("之后重新启动服务")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"配置阿里云镜像加速器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置阿里云镜像加速器"}},[s._v("#")]),s._v(" 配置阿里云镜像加速器")]),s._v(" "),e("ul",[e("li",[s._v("访问阿里云登录自己的账号查看 docker 镜像加速服务："),e("a",{attrs:{href:"https://cr.console.aliyun.com/cn-shenzhen/instances/mirrors",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://cr.console.aliyun.com/cn-shenzhen/instances/mirrors"),e("OutboundLink")],1)])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting1@master/20220904/image.1zbgqzzakxeo.webp",alt:"image"}})]),s._v(" "),e("p",[s._v("操作步骤是统一的，不存在不同用户不同的操作步骤，我已经放到下面代码块：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /etc/docker\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n  "registry-mirrors": ["https://7sbpp63d.mirror.aliyuncs.com"]\n}\nEOF')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("之后重新启动服务")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("验证 docker 的镜像加速器是否生效")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker info")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#结果")]),s._v("\nClient:\n Context:    default\n Debug Mode: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n Registry: https://index.docker.io/v1/\n Labels:\n Experimental: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Insecure Registries:\n  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.0/8\n Registry Mirrors:\n  https://7sbpp63d.mirror.aliyuncs.com/\n Live Restore Enabled: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h2",{attrs:{id:"镜像查看和拉取"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#镜像查看和拉取"}},[s._v("#")]),s._v(" 镜像查看和拉取")]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("拉一个 docker 镜像试试吧？")])])]),s._v(" "),e("p",[s._v("拉取 hello world")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行改命令")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull hello-world:latest")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 结果")]),s._v("\nlatest: Pulling from library/hello-world\nDigest: sha256:2498fce14358aa50ead0cc6c19990fc6ff866ce72aeb5546e1d59caac3d0d60f\nStatus: Image is up to "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" hello-world:latest\ndocker.io/library/hello-world:latest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("看本地仓库是否有这个库")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("br"),e("br"),e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br")]),e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行改命令")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 结果")]),s._v("\nREPOSITORY    TAG       IMAGE ID       CREATED         SIZE\nhello-world   latest    feb5d9fea6a5   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" months ago   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".3kB\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("运行这个镜像的实例，即容器")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run hello-world")]),s._v("\n\nHello from Docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nThis message shows that your installation appears to be working correctly.\n\nTo generate this message, Docker took the following steps:\n "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". The Docker client contacted the Docker daemon.\n "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". The Docker daemon pulled the "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello-world"')]),s._v(" image from the Docker Hub.\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amd64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". The Docker daemon created a new container from that image "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" runs the\n    executable that produces the output you are currently reading.\n "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". The Docker daemon streamed that output to the Docker client, "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" sent it\n    to your terminal.\n\nTo try something "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" ambitious, you can run an Ubuntu container with:\n $ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" ubuntu "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n\nShare images, automate workflows, and "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" with a "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" Docker ID:\n https://hub.docker.com/\n\nFor "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" examples and ideas, visit:\n https://docs.docker.com/get-started/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("blockquote",[e("p",[s._v("注意, 如果你在没有镜像的时候，直接 "),e("code",[s._v("docker run hello-world")]),s._v(" 也是可以的；它会先检查本地是否有这个镜像，没有的话会先从指定仓库中拉取。")])]),s._v(" "),e("ul",[e("li",[s._v("run干了什么？")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting1@master/20220904/image.4fq3ksgij3g.webp",alt:"image"}})]),s._v(" "),e("h2",{attrs:{id:"为什么docker会比vm虚拟机快"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为什么docker会比vm虚拟机快"}},[s._v("#")]),s._v(" 为什么Docker会比VM虚拟机快")]),s._v(" "),e("ol",[e("li",[e("strong",[s._v("docker有着比虚拟机更少的抽象层")])])]),s._v(" "),e("p",[s._v("由于docker不需要Hypervisor(虚拟机)实现硬件资源虚拟化,运行在docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在效率上有明显优势。")]),s._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[e("strong",[s._v("docker利用的是宿主机的内核,而不需要加载操作系统OS内核")])])]),s._v(" "),e("p",[s._v("当新建一个容器时,docker不需要和虚拟机一样重新加载一个操作系统内核。进而避免引寻、加载操作系统内核返回等比较费时费资源的过程,当新建一个虚拟机时,虚拟机软件需要加载OS,返回新建过程是分钟级别的。而docker由于直接利用宿主机的操作系统,则省略了返回过程,因此新建一个docker容器只需要几秒钟。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting1@master/20220904/image.4xh8wae98fk0.webp",alt:"image"}})]),s._v(" "),e("table",[e("thead",[e("tr",[e("th"),s._v(" "),e("th",[s._v("Docker容器")]),s._v(" "),e("th",[s._v("虚拟机(VM)")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("操作系统")]),s._v(" "),e("td",[s._v("与宿主机共享OS")]),s._v(" "),e("td",[s._v("宿主机OS上运行虚拟机OS")])]),s._v(" "),e("tr",[e("td",[s._v("存储大小")]),s._v(" "),e("td",[s._v("镜像小，便于存储与运输")]),s._v(" "),e("td",[s._v("镜像庞大(vmdk、vdi等)")])]),s._v(" "),e("tr",[e("td",[s._v("运行性能")]),s._v(" "),e("td",[s._v("几乎无额外性能损失")]),s._v(" "),e("td",[s._v("操作系统额外的CPU、内存消耗")])]),s._v(" "),e("tr",[e("td",[s._v("移植性")]),s._v(" "),e("td",[s._v("轻便、灵活、适应于Linux")]),s._v(" "),e("td",[s._v("笨重，与虚拟机技术耦合度高")])]),s._v(" "),e("tr",[e("td",[s._v("硬件亲和性")]),s._v(" "),e("td",[s._v("面向软件开发者")]),s._v(" "),e("td",[s._v("面向硬件运维者")])]),s._v(" "),e("tr",[e("td",[s._v("部署速度")]),s._v(" "),e("td",[s._v("快速，秒级")]),s._v(" "),e("td",[s._v("较慢。10s以上")])])])]),s._v(" "),e("h2",{attrs:{id:"卸载docker引擎"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#卸载docker引擎"}},[s._v("#")]),s._v(" 卸载Docker引擎")]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("卸载 Docker Engine、CLI 和 Containerd 包")])])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[e("strong",[s._v("主机上的映像、容器、卷或自定义配置文件不会自动删除。删除所有镜像、容器和卷")])])]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/docker\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/containerd\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("您必须手动删除任何已编辑的配置文件")])])}),[],!1,null,null,null);e.default=n.exports}}]);