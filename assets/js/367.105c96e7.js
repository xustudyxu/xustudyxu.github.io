(window.webpackJsonp=window.webpackJsonp||[]).push([[367],{716:function(t,v,_){"use strict";_.r(v);var a=_(10),r=Object(a.a)({},(function(){var t=this,v=t._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"linux-定时任务调度"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#linux-定时任务调度"}},[t._v("#")]),t._v(" Linux 定时任务调度")]),t._v(" "),v("h2",{attrs:{id:"crond-任务调度"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#crond-任务调度"}},[t._v("#")]),t._v(" crond 任务调度")]),t._v(" "),v("p",[t._v("crond 进行定时任务的设置")]),t._v(" "),v("h3",{attrs:{id:"概述"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),v("p",[t._v("任务调度:是指系统在某个时间执行的特定的命令或程序")]),t._v(" "),v("p",[t._v("任务调度分类:1.系统工作:有些重要的工作必须周而复始地执行。如病毒扫描等")]),t._v(" "),v("p",[t._v("个别用户工作:个别用户可能希望执行某些程序，比如对mysql数据库的备份。示意图")]),t._v(" "),v("p",[v("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting@master/studynotes/Linux/images/9/01.png",alt:"01"}})]),t._v(" "),v("h3",{attrs:{id:"基本语法"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#基本语法"}},[t._v("#")]),t._v(" 基本语法")]),t._v(" "),v("p",[v("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[t._v("crontab [选项]")])],1),t._v(" "),v("h3",{attrs:{id:"常用选项"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#常用选项"}},[t._v("#")]),t._v(" 常用选项")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("选项")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("-e")]),t._v(" "),v("td",[t._v("编辑crontab定时任务")])]),t._v(" "),v("tr",[v("td",[t._v("-l")]),t._v(" "),v("td",[t._v("查询crontab任务")])]),t._v(" "),v("tr",[v("td",[t._v("-r")]),t._v(" "),v("td",[t._v("删除当前用户所有的crontab任务")])])])]),t._v(" "),v("h3",{attrs:{id:"快速入门"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#快速入门"}},[t._v("#")]),t._v(" 快速入门")]),t._v(" "),v("p",[t._v("设置任务调度文件: letc/crontab")]),t._v(" "),v("p",[t._v("设置个人任务调度。执行"),v("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[t._v("crontab-e")]),t._v("命令。接着输入任务到调度文件")],1),t._v(" "),v("p",[t._v("如:* /1* * * * ls -l/etc/ > /tmp/to.txt")]),t._v(" "),v("p",[t._v("意思说每小时的每分钟执行Is -l letc/  > /tmp/to.txt命令")]),t._v(" "),v("ul",[v("li",[t._v("参数细节说明")])]),t._v(" "),v("p",[t._v("5个占位符说明")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("项目")]),t._v(" "),v("th",[t._v("含义")]),t._v(" "),v("th",[t._v("范围")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v('第一个"*"')]),t._v(" "),v("td",[t._v("一个小时当中的第几分钟")]),t._v(" "),v("td",[t._v("0-59")])]),t._v(" "),v("tr",[v("td",[t._v('第二个"*"')]),t._v(" "),v("td",[t._v("一天当中的第几小时")]),t._v(" "),v("td",[t._v("0-23")])]),t._v(" "),v("tr",[v("td",[t._v('第三个"*"')]),t._v(" "),v("td",[t._v("一个月当中的第几天")]),t._v(" "),v("td",[t._v("1-31")])]),t._v(" "),v("tr",[v("td",[t._v('第四个"*"')]),t._v(" "),v("td",[t._v("一年当中的第几月")]),t._v(" "),v("td",[t._v("1-12")])]),t._v(" "),v("tr",[v("td",[t._v('第五个"*"')]),t._v(" "),v("td",[t._v("一周当中的星期几")]),t._v(" "),v("td",[t._v("0-7(0和7都代表星期日)")])])])]),t._v(" "),v("ul",[v("li",[t._v("特殊符号的说明")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("特殊符号")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("*")]),t._v(" "),v("td",[t._v('代表任何时间。比如一个"*"就代表一小时中每分钟都执行一次的意思。')])]),t._v(" "),v("tr",[v("td",[t._v("，")]),t._v(" "),v("td",[t._v('代表不连续的时间。比如"0 8,12,16 * * *命令"，就代表在每天的8点0分，12点0分，16点0分都执行一次命令')])]),t._v(" "),v("tr",[v("td",[t._v("-")]),t._v(" "),v("td",[t._v('代表连续的时间范围。比如"0 5 * * 1-6命令"，就代表周一到周六的凌晨5点0分执行命令')])]),t._v(" "),v("tr",[v("td",[t._v("*/n")]),t._v(" "),v("td",[t._v('代表没隔多久执行一次。比如"*/10 * * * * 命令"，代表每隔10分钟就执行一遍命令')])])])]),t._v(" "),v("ul",[v("li",[t._v("特殊时间执行案例")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("时间")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("45 22 * * * 命令")]),t._v(" "),v("td",[t._v("在22点45分执行命令")])]),t._v(" "),v("tr",[v("td",[t._v("0 17 * * 1 命令")]),t._v(" "),v("td",[t._v("每周1的17点0分执行命令")])]),t._v(" "),v("tr",[v("td",[t._v("0 5 1,15 * * 命令")]),t._v(" "),v("td",[t._v("每月1号和15号的凌晨5点0分执行命令")])]),t._v(" "),v("tr",[v("td",[t._v("40 4 * * 1-5  命令")]),t._v(" "),v("td",[t._v("每周一到周五的凌晨4点40分执行命令")])]),t._v(" "),v("tr",[v("td",[t._v("*/10 4 * * * 命令")]),t._v(" "),v("td",[t._v("每天的凌晨4点，每隔10分钟执行以此命令")])]),t._v(" "),v("tr",[v("td",[t._v("0 0 1,15 * 1 命令")]),t._v(" "),v("td",[t._v("每月1号和15号，每周1的0点0分都会执行命令.")])])])]),t._v(" "),v("ul",[v("li",[t._v("注意:星期几和几号最好不要同时出现，因为他们定义的都是天，非常容易让程序员混乱.")])]),t._v(" "),v("h3",{attrs:{id:"应用实例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#应用实例"}},[t._v("#")]),t._v(" 应用实例")]),t._v(" "),v("p",[t._v("案例1:每隔1分钟，就将当前的日期信息，追加到/tmp/mydate文件中")]),t._v(" "),v("p",[t._v("*/1 * * * * date >> /tmp/mydate")]),t._v(" "),v("p",[t._v("案例2:每隔1分钟，将当前日期和日历都追加到/home/mycal文件中")]),t._v(" "),v("p",[t._v("步骤:")]),t._v(" "),v("p",[t._v("(1 ) vim /home/my.sh写入内容 date >> /home/mycal和cal >>/home/mycal")]),t._v(" "),v("p",[t._v("(2)给my.sh增加执行权限，chmod u+x /home/my.sh")]),t._v(" "),v("p",[t._v("(3) crontab -e增加 "),v("em",[t._v("/1 * * * * /home/my.sh")])]),t._v(" "),v("p",[t._v("案例3:每天凌晨2:00将mysql数据库testdb ，备份到文件中。提示:指令为mysqldump -u root -p密码数据库 > /home/db.bak")]),t._v(" "),v("p",[t._v("步骤(1) crontab -e")]),t._v(" "),v("p",[t._v("步骤(2)0 2 * * *mysqldump -u root -proot testdb > /home/db.bak")]),t._v(" "),v("h3",{attrs:{id:"crond相关指令"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#crond相关指令"}},[t._v("#")]),t._v(" crond相关指令")]),t._v(" "),v("p",[v("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[t._v("conrtab -r:终止任务调度。")])],1),t._v(" "),v("p",[v("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[t._v("crontab -l:列出当前有那些任务调度")])],1),t._v(" "),v("p",[v("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[t._v("service crond restart [重启任务调度]")])],1),t._v(" "),v("h2",{attrs:{id:"at定时任务"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#at定时任务"}},[t._v("#")]),t._v(" at定时任务")]),t._v(" "),v("h3",{attrs:{id:"基本介绍"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#基本介绍"}},[t._v("#")]),t._v(" 基本介绍")]),t._v(" "),v("ol",[v("li",[v("p",[t._v("at命令是一次性定时计划任务，at的守护进程 atd 会以后台模式运行，检查作业队列来运行。")])]),t._v(" "),v("li",[v("p",[t._v("默认情况下，atd守护进程每60秒检查作业队列，有作业时，会检查作业运行时间，如果时间与当前时间匹配，则运行此作业。")])]),t._v(" "),v("li",[v("p",[t._v("at命令是一次性定时计划任务，执行完一个任务后不再执行此任务了")])]),t._v(" "),v("li",[v("p",[t._v("在使用at命令的时候，一定要保证atd进程的启动﹐可以使用相关指令来查看")]),t._v(" "),v("p",[t._v("ps -ef l grep atd //可以检测atd是否在行")])]),t._v(" "),v("li",[v("p",[t._v("一个示意图")])])]),t._v(" "),v("p",[v("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting@master/studynotes/Linux/images/9/02.png",alt:"02"}})]),t._v(" "),v("h3",{attrs:{id:"at-命令格式"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#at-命令格式"}},[t._v("#")]),t._v(" at 命令格式")]),t._v(" "),v("p",[v("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[t._v("at [选项] [时间]")])],1),t._v(" "),v("p",[t._v("Ctrl+D 结束at命令的输入，输入两次")]),t._v(" "),v("h3",{attrs:{id:"at-命令选项"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#at-命令选项"}},[t._v("#")]),t._v(" at 命令选项")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("选项")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("-m")]),t._v(" "),v("td",[t._v("当指定的任务被完成后，讲给用户发送邮件，即使没有标准输出")])]),t._v(" "),v("tr",[v("td",[t._v("-I")]),t._v(" "),v("td",[t._v("atq的别名")])]),t._v(" "),v("tr",[v("td",[t._v("-d")]),t._v(" "),v("td",[t._v("atrm的别名")])]),t._v(" "),v("tr",[v("td",[t._v("-v")]),t._v(" "),v("td",[t._v("显示任务将被执行的时间")])]),t._v(" "),v("tr",[v("td",[t._v("-c")]),t._v(" "),v("td",[t._v("打印任务的内容到标准输出")])]),t._v(" "),v("tr",[v("td",[t._v("-V")]),t._v(" "),v("td",[t._v("显示版本信息")])]),t._v(" "),v("tr",[v("td",[t._v("-q <队列>")]),t._v(" "),v("td",[t._v("使用指定的队列")])]),t._v(" "),v("tr",[v("td",[t._v("-f <文件>")]),t._v(" "),v("td",[t._v("从指定文件读入任务而不是从标准输入的读入")])]),t._v(" "),v("tr",[v("td",[t._v("-t <时间参数>")]),t._v(" "),v("td",[t._v("以时间参数的形式提交要运行的任务")])])])]),t._v(" "),v("h3",{attrs:{id:"at-时间定义"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#at-时间定义"}},[t._v("#")]),t._v(" at 时间定义")]),t._v(" "),v("ul",[v("li",[t._v("at指定时间的方法:")])]),t._v(" "),v("ol",[v("li",[v("strong",[t._v("接受在当天的hmm(小时:分钟）式的时间指定。假如该时间已过去，那么就放在第二天执行")]),t._v("       例如:04:00")]),t._v(" "),v("li",[v("strong",[t._v("使用mihnight(深夜)，noon(中午) , teatime(饮茶时间，一般是下午4点）等比较模糊的词语来指定时间")])]),t._v(" "),v("li",[v("strong",[t._v("采用12小时计时制，即在时间后面加上AM (上午)或PM(下午〉来说明是上午还是下午。")]),t._v("      例如: 12pm")]),t._v(" "),v("li",[v("strong",[t._v("指定命令执行的具体日期，指定格式为month day(月日)或mm/ddyy (月/日/年）或dd.mm.yy (日.月.年)，指定的日期必须跟在指定时间的后面。")]),t._v("     例如:04:00 2021-03-1")]),t._v(" "),v("li",[v("strong",[t._v("使用相对计时法。指定格式为: now + count time-units ,now就是当前时间, time-units是时间单位,这里能够是minutes(分钟)、hours(小时)、days(天)、weeks (星期)。count 是时间的数量，几天，几小时")]),t._v("  例如: now + 5 minutes")]),t._v(" "),v("li",[v("strong",[t._v("直接使用today(今天)、tomorrow(明天)来指定完成命令的时间。")])])]),t._v(" "),v("h3",{attrs:{id:"应用实例-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#应用实例-2"}},[t._v("#")]),t._v(" 应用实例")]),t._v(" "),v("p",[t._v("案例1：2天后的下午5点执行 /bin/ls/home")]),t._v(" "),v("p",[v("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting@master/studynotes/Linux/images/9/03.png",alt:"03"}})]),t._v(" "),v("p",[t._v("案例2：atp命令来查看系统中没有执行的工作任务")]),t._v(" "),v("p",[v("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting@master/studynotes/Linux/images/9/04.png",alt:"04"}})]),t._v(" "),v("p",[t._v("案例3：明天17点钟，输出时间到指定文件内比如 /root/date100.log")]),t._v(" "),v("p",[v("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting@master/studynotes/Linux/images/9/05.png",alt:"05"}})]),t._v(" "),v("p",[t._v("案例4：2分钟后，输出时间到指定文件内比如 /root/date200.log")]),t._v(" "),v("p",[v("img",{attrs:{src:"https://jsdelivr.codeqihan.com//gh/xustudyxu/image-hosting@master/studynotes/Linux/images/9/06.png",alt:"06"}})]),t._v(" "),v("p",[t._v("案例5:删除已经配置的任务，atm编号")]),t._v(" "),v("p",[t._v("atrm 4 //表示将job队列，编号为4的job删除")])])}),[],!1,null,null,null);v.default=r.exports}}]);